# Nexy AI Assistant - Development Rules

## üìã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –ß–¢–ï–ù–ò–ï –ö–û–ù–¢–ï–ö–°–¢–ê
–ü–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –í–°–ï–ì–î–ê –∏–∑—É—á–∞–π —ç—Ç–∏ –∫–ª—é—á–µ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ UX
- `Docs/PRODUCT_CONCEPT.md` - –û–°–ù–û–í–ù–û–ô –∫–æ–Ω—Ü–µ–ø—Ç –ø—Ä–æ–¥—É–∫—Ç–∞, UX-—Å—Ü–µ–Ω–∞—Ä–∏–∏, 3 —Ä–µ–∂–∏–º–∞ (SLEEPING/LISTENING/PROCESSING)
- `Docs/GLOBAL_DELIVERY_PLAN.md` - –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ—Å—Ç–∞–≤–∫–∏, Azure VM, –ø–æ–¥–ø–∏—Å—å/–Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—è
- `Docs/PACKAGING_PLAN.md` - –ü–ª–∞–Ω –ø–æ —É–ø–∞–∫–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è PKG 
- `Docs/ARCHITECTURE_OVERVIEW.md` - –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–≥–∏–∫–∞ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
- `Docs/CURRENT_STATUS_REPORT.md` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- –°—Ç—Ä–æ–≥–æ 3 —Ä–µ–∂–∏–º–∞: SLEEPING (—Å–µ—Ä—ã–π), LISTENING (—Å–∏–Ω–∏–π –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–π), PROCESSING (–∂–µ–ª—Ç—ã–π –≤—Ä–∞—â–∞—é—â–∏–π—Å—è)
- Push-to-Talk: –¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –ü–†–û–ë–ï–õ ‚Üí LISTENING, –æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ ‚Üí PROCESSING
- EventBus –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –≤—Å–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è
- –¢–æ–Ω–∫–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ - –ù–ï –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –º–æ–¥—É–ª–µ–π
- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: client/modules/, integration/integrations/

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- macOS –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –º–µ–Ω—é-–±–∞—Ä–æ–º (rumps)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è: microphone, screen_capture, network, notifications
- gRPC –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Sparkle (—Ç–∏—Ö–∏–π —Ä–µ–∂–∏–º)
- Azure VM: IP 20.151.51.172, Team ID: 5NKLL2CLB9, Bundle ID: com.nexy.assistant

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (–ö–†–ò–¢–ò–ß–ù–û –£–ß–ò–¢–´–í–ê–¢–¨)
‚úÖ –ó–ê–í–ï–†–®–ï–ù–ù–´–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò (9 –∏–∑ 12):
- TrayControllerIntegration, PermissionsIntegration, InputProcessingIntegration
- UpdateManagerIntegration, NetworkManagerIntegration, AudioDeviceIntegration
- InterruptManagementIntegration, VoiceRecognitionIntegration, ScreenshotCaptureIntegration

üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ò–û–†–ò–¢–ï–¢–´ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å):
1. HardwareIdIntegration (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è GrpcClient)
2. GrpcClientIntegration (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç Hardware ID)
3. SpeechPlaybackIntegration (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç GrpcClient)

## üö´ –ó–ê–ü–†–ï–¢–´
- –ù–ï –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥—É–ª–µ–π
- –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã –∫—Ä–æ–º–µ SLEEPING/LISTENING/PROCESSING
- –ù–ï –Ω–∞—Ä—É—à–∞—Ç—å EventBus –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- –ù–ï —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–æ–¥—É–ª—è–º–∏ –Ω–∞–ø—Ä—è–º—É—é (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- –ù–ï –º–µ–Ω—è—Ç—å Bundle ID, Team ID, —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –†–ê–ó–†–ê–ë–û–¢–ö–ò (–û–ë–ù–û–í–õ–ï–ù–û)
1. HardwareIdIntegration (–ö–†–ò–¢–ò–ß–ù–û - –±–µ–∑ –Ω–µ–≥–æ GrpcClient –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
2. GrpcClientIntegration (–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Azure —Å–µ—Ä–≤–µ—Ä)
3. SpeechPlaybackIntegration (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ PROCESSING ‚Üí SLEEPING)
4. ModeManagementIntegration (FSM –ª–æ–≥–∏–∫–∞)
5. Workflows (listening_workflow.py, processing_workflow.py)

## üìù –°–¢–ò–õ–¨ –ö–û–î–ê
- Python 3.11+, type hints –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- Async/await –¥–ª—è gRPC –∏ —Å–µ—Ç–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ unified_config_loader
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML —Ñ–∞–π–ª—ã –≤ config/
- –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
- –°–µ–∫—Ä–µ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ environment variables –∏–ª–∏ Keychain
- App-Specific Password: qtiv-kabm-idno-qmbl (–í–†–ï–ú–ï–ù–ù–û, —Ç—Ä–µ–±—É–µ—Ç —Ä–æ—Ç–∞—Ü–∏–∏)
- –ü–æ–¥–ø–∏—Å—å –∫–æ–¥–∞ —á–µ—Ä–µ–∑ Developer ID Application/Installer

## üîÑ WORKFLOW –†–ê–ó–†–ê–ë–û–¢–ö–ò
- –í—Å–µ–≥–¥–∞ —á–∏—Ç–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ç–æ–Ω–∫–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –Ω–µ –¥—É–±–ª–∏—Ä—É—è –∫–æ–¥ –º–æ–¥—É–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EventBus –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ
- –û–±–Ω–æ–≤–ª—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## üìä –¢–ï–ö–£–©–ò–ï –ó–ê–î–ê–ß–ò (–∏–∑ INTEGRATION_MASTER_PLAN.md)
### –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì: HardwareIdIntegration
**–ó–∞–¥–∞—á–∏:**
- –°–æ–∑–¥–∞—Ç—å `HardwareIdIntegration` (—Ç–æ–Ω–∫–∞—è –æ–±–µ—Ä—Ç–∫–∞)
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫ EventBus
- –ü–æ–ª—É—á–∏—Ç—å hardware_id –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (app.startup)
- –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `hardware.id_obtained` —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ID –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å SimpleModuleCoordinator

**–¢–µ—Å—Ç-–≥–µ–π—Ç:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ–ª—É—á–µ–Ω hardware_id, –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è GrpcClient

**–ó–ê–í–ò–°–ò–ú–û–°–¢–¨:** GrpcClient —Ç—Ä–µ–±—É–µ—Ç hardware_id –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –≤ StreamRequest

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–ê–í–ò–õ–ê
### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π:
```python
class SomeIntegration:
    def __init__(self, event_bus, state_manager):
        self.event_bus = event_bus
        self.state_manager = state_manager
        self.module = SomeModule()  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å
        
    def initialize(self):
        # –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
        self.event_bus.subscribe("some.event", self.handle_event)
        
    def handle_event(self, event):
        # –¢–æ–Ω–∫–∞—è –æ–±–µ—Ä—Ç–∫–∞ - –¥–µ–ª–µ–≥–∏—Ä—É–µ–º –º–æ–¥—É–ª—é
        result = self.module.do_something()
        self.event_bus.publish("result.ready", result)
```

### EventBus —Å–æ–±—ã—Ç–∏—è (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏):
- `app.mode_changed` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `voice.recording_start/stop` - –Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –∑–∞–ø–∏—Å–∏ –≥–æ–ª–æ—Å–∞
- `voice.recognition_completed/failed` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- `network.status_changed` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ç–∏
- `permission.all_granted` - –≤—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `client/config/*.yaml`
- –ò—Å–ø–æ–ª—å–∑—É–π `unified_config_loader.py` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤
- gRPC –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `grpc_host`, `grpc_port`, `use_tls`
- Sparkle –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `appcast_url`, `check_interval`

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `integration/tests/`
- –ú–æ–∫–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å EventBus –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏

## üìö –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `logging_manager.py`
- –§–æ—Ä–º–∞—Ç: `2025-09-15 14:30:00 - Nexy - INFO - Application started`
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
- –ù–ï –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (PII)

## üöÄ –†–ï–ñ–ò–ú–´ –†–ê–ë–û–¢–´ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
### SLEEPING (—Å–µ—Ä—ã–π –∫—Ä—É–∂–æ–∫)
- –ú–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω
- –§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

### LISTENING (—Å–∏–Ω–∏–π –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–π)
- –ê–∫—Ç–∏–≤–µ–Ω –º–∏–∫—Ä–æ—Ñ–æ–Ω
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### PROCESSING (–∂–µ–ª—Ç—ã–π –≤—Ä–∞—â–∞—é—â–∏–π—Å—è)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
